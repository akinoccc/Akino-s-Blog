<!DOCTYPE html>
<html data-theme="light">

<head>
  <title>Akino's Blog</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="
      width=device-width, 
      initial-scale=1.0, 
      minimum-scale=1.0, 
      maximum-scale=1.0,
      user-scalable=no
    " />
  <link rel="icon" href="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/logo.png">

  
<link rel="stylesheet" href="/css/main.css">


  
<script src="/js/lib/jquery-3.6.3.min.js" defer></script>

  
  
<script src="/js/lib/highlight.min.js" defer></script>

  
<script src="/js/main.js" type="module" defer></script>

  
<script src="/js/theme.js" type="module" defer></script>

  
<script src="/js/page/header.js" type="module" defer></script>

  
<script src="/js/page/side-menu.js" type="module" defer></script>

  
<script src="/js/page/search/index.js" defer></script>


  
  
<script src="/js/lib/valine.min.js"></script>

  
  
  

  

  
  
<script src="/js/page/search/local-search.js" type="module" defer></script>

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body style="position: relative;">
  
<div id="loading-box">
  <div class="wave">
    <div class="wave-child wave1"></div>
    <div class="wave-child wave2"></div>
    <div class="wave-child wave3"></div>
    <div class="wave-child wave4"></div>
    <div class="wave-child wave5"></div>
  </div>
</div>

<script>
  window.addEventListener("load", function() {
    document.body.style.overflow = "auto";
    document.getElementById("loading-box").classList.add("loaded")
  }, false)
</script>

  <div class="bg-wrapper">
  <canvas id="bg-canvas" />
</div>
  <div class="side-menu-container animate__animated animate__faster">
  <ul class="menu animate__animated animate__faster">
    <li class="menu-item"}><a href="/" title="首页">首页</a></li><li class="menu-item"}><a href="/projects" title="项目">项目</a></li><li class="menu-item"}><a href="/about" title="关于">关于</a></li><li class="menu-item"}><a href="/message" title="留言板">留言板</a></li><li class="menu-item"}><a href="/links" title="友链">友链</a></li>
    <li class="category-menu-wrapper">
      <div class="menu-item-name">
        <span>分类</span>
        <span class="iconfont icon-chevron-bottom"></span>
      </div>
      <ul class="category-menu-list"><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E5%85%B6%E5%AE%83/">其它</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E6%B1%82%E8%81%8C/">求职</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/">版本管理</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul>
    </li>
    <li class="iconfont icon-close-circle"></li>
  </ul>
</div>
  
<div class="search-pop-overlay">
  <div class="popup search-popup">
    
    <div class="search-header">
  <h2 class="search-title">
    本地搜索
    <i class="popup-btn-close iconfont icon-close"></i>
  </h2>
  <div class="search-input-container">
    <input class="search-input" autocomplete="off" autocapitalize="off" maxlength="80" placeholder="请输入关键字" spellcheck="false" type="search">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result flex flex-column">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>    
  </div>
</div>

  <header class="main-header animate__animated animate__fadeInDown">
  <a class="blogger-info flex flex-align-center" href="/">
    <img src="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/logo.png" alt="avatar">
    <span>Akino's Blog </span>
  </a>
  <nav>
    <ul class="menu flex flex-align-center">
      <li class="menu-item"}><a href="/" title="首页">首页</a></li><li class="menu-item"}><a href="/projects" title="项目">项目</a></li><li class="menu-item"}><a href="/about" title="关于">关于</a></li><li class="menu-item"}><a href="/message" title="留言板">留言板</a></li><li class="menu-item"}><a href="/links" title="友链">友链</a></li>
      <li class="menu-category">
        <div class="flex flex-align-center">
          <span>分类</span>
          <span class="iconfont icon-chevron-bottom"></span>
        </div>
        <ul class="category-menu-list"><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E5%85%B6%E5%AE%83/">其它</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E6%B1%82%E8%81%8C/">求职</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/">版本管理</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></li><li class="category-menu-list-item"><a class="category-menu-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul>
      </li>
    </ul>
  </nav>
  <div class="right-icon flex flex-align-center">
    <span class="search-popup-trigger iconfont icon-search"></span>
    <span class="iconfont icon-view-list"></span>
  </div>
</header>
<div class="header-slot"></div>
  <main class="page-container">
    <div class="page-post-container animate__animated animate__fadeIn">
  <section class="post-wrapper">
    <header class="post-header">
      
      <img class="post-cover" src="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/covers/js_instanceof.png" alt="Instanceof底层原理详解">
      
      
      <span class="post-title">Instanceof底层原理详解</span>
      
      <div class="post-publish-info-wrapper flex">
        <img class="author-avatar" src="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/logo.png" alt="">
        <div class="post-info flex flex-column flex-space-around">
          <div>
            Akino
            <span>· 03/14, 2023 · </span>
            <span id="/2023/03/14/Instanceof%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3/" class="leancloud_visitors" data-flag-title="Instanceof底层原理详解">
              阅读
              
            </span>
          </div>
          <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li></ul>
        </div>
        </span>
      </div>
    </header>
    <article class="post-content markdown">
      <!-- <a name="index" style=" position: relative;top: -120px;display: block;height: 0;overflow: hidden;"></a> -->
      <h2 id="作用">作用</h2>
<ul>
<li>
<p>用于判断某个实例是否基于某个构造函数创建</p>
</li>
<li>
<p>在继承关系中用于判断一个实例是否属于它的父类型或者祖先类型的实例</p>
</li>
</ul>
<h2 id="实现原理">实现原理</h2>
<p>其实从作用很容易看出来内部是基于什么逻辑去判断</p>
<p>众所周知，js 的 <code>OOP</code> 是基于原型链去实现的，而 <code>instanceof</code> 就是基于原型链去判断实例是否从目标构造函数创建的。</p>
<p>下面通过重写一步步还原 <code>instanceof</code>，以更进一步去理解其原理。</p>
<h3 id="示例">示例</h3>
<blockquote>
<p>A instanceof B</p>
</blockquote>
<ol>
<li>基本结构：两个参数，实例和要对比的构造函数</li>
</ol>
<pre><code class="language-js">function instanceOf(L, R) &#123;&#125;
</code></pre>
<ol start="2">
<li>通过实例的<code>__proto__</code>沿着原型寻找目标构造函数的<code>prototype</code>，直到<code>null</code>停止对比</li>
</ol>
<pre><code class="language-js">function instanceOf(L, R) &#123;
  L = L.__proto__;
  R = R.prototype;
  while (L !== null) &#123;
    if (L === R) &#123;
      return true;
    &#125;
    L = L.__proto__;
  &#125;
  return false;
&#125;
</code></pre>
<p>此时一个原型判断函数已经基本完成</p>
<ol start="3">
<li>注意点：</li>
</ol>
<p>当然没有这么简单就完结了，<code>instanceof</code>对于基本数据类型以及一些特殊值是无效的，统统输出<code>false</code>。</p>
<pre><code class="language-js">1 instanceof Number; // false
'' instanceof String; // false
Number instanceof Number; // false
null instanceof Object; // false
Func instanceof Fun; // false, 函数比较
</code></pre>
<p>但是以下判断是正确的：</p>
<pre><code class="language-js">new Number(1) instanceof Number; // true
</code></pre>
<p>因为通过<code>new</code>关键字实例化出<code>Number</code>对象了，而不再是基本数据类型了。</p>
<p>因此因此，还需要加上一些额外的判断。</p>
<pre><code class="language-js">function instanceOf(L, R) &#123;
  if (L === null || typeof L !== 'object') &#123;
    return false;
  &#125;
  L = L.__proto__;
  R = R.prototype;
  while (L !== null) &#123;
    if (L === R) &#123;
      return true;
    &#125;
    L = L.__proto__;
  &#125;
  return false;
&#125;
</code></pre>

    </article>
    <!--  -->
    <div class="post-prev-next">
  
  <div class="link-wrapper">
    
    <a style="background-image: url(/images/no-cover.png);" class="link-cover" href="/2023/05/29/Github%20Action%E4%B8%AD%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4TOKEN%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/">
      <div class="overlay"></div>
    </a>
    
    <div class="link-text">
      <span>上一篇</span>
      <span class="link-title">Github Action 中使用默认 GITHUB_TOKEN 权限问题</span>
    </div>
  </div>
  
  
  <div class="link-wrapper">
    
    <a style="background-image: url(/images/no-cover.png);" class="link-cover" href="/2023/03/10/Electron%E8%B8%A9%E5%9D%91%E4%B8%93%E9%A2%98/">
      <div class="overlay"></div>
    </a>
    
    <div class="link-text">
      <span>下一篇</span>
      <span class="link-title">Electron 踩坑专题</span>
    </div>
  </div>
  
</div>
    
    

<div class="divide"></div>


<div class="iconfont icon-comment"><span>评论</span></div>

<div id="comment" class="comment markdown"></div>


<script src="/js/lib/valine.min.js"></script>

<script>
  new Valine({
    el: '#comment',
    lang: "zh-CN",
    ...JSON.parse('{"enable":true,"appId":"3QKRVHpL9EPJpCUkekn4XDbR-gzGzoHsz","appKey":"BrY6HeaAcdwDscZNxC3TM7LO","avatar":"retro","placeholder":"ヾﾉ≧∀≦)o来啊，快活啊!","pageSize":15,"visitor":true,"recordIP":true}')
  });
</script>


    
  </section>
  <section class="aside-wrapper">
  <aside class="aside-content">
    <div class="aside-card post-toc">
      <header class="aside-card-title">
        <span class="iconfont icon-toc"></span>目录
      </header>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">2.</span> <span class="toc-text">实现原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.1.</span> <span class="toc-text">示例</span></a></li></ol></li></ol>
    </div>
    <div class="aside-card latest-posts">
      <header class="aside-card-title">
        <span class="iconfont icon-history"></span>最新推荐
      </header>
      <ul class="latest-post-list">
    <li class="latest-post">
      <a class="post-link" href="/2023/05/29/Github%20Action%E4%B8%AD%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4TOKEN%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/">
        <img class="post-cover" src="/images/no-cover.png" />
        <div class="post-info">
          <span class="title">Github Action 中使用默认 GITHUB_TOKEN 权限问题</span>
          <span class="time">2023-05-29</span>
        </div>
      </a>
    </li>
  
    <li class="latest-post">
      <a class="post-link" href="/2023/03/14/Instanceof%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3/">
        <img class="post-cover" src="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/covers/js_instanceof.png" />
        <div class="post-info">
          <span class="title">Instanceof底层原理详解</span>
          <span class="time">2023-03-14</span>
        </div>
      </a>
    </li>
  
    <li class="latest-post">
      <a class="post-link" href="/2023/03/10/Electron%E8%B8%A9%E5%9D%91%E4%B8%93%E9%A2%98/">
        <img class="post-cover" src="/images/no-cover.png" />
        <div class="post-info">
          <span class="title">Electron 踩坑专题</span>
          <span class="time">2023-03-10</span>
        </div>
      </a>
    </li>
  
    <li class="latest-post">
      <a class="post-link" href="/2023/03/02/Hexo%E4%B8%BB%E9%A2%98%EF%BC%9Ahexo-theme-alog/">
        <img class="post-cover" src="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/covers/hexo-theme-alog.png" />
        <div class="post-info">
          <span class="title">Hexo主题：Alog</span>
          <span class="time">2023-03-02</span>
        </div>
      </a>
    </li>
  
    <li class="latest-post">
      <a class="post-link" href="/2022/09/02/uniapp%E8%8E%B7%E5%8F%96%E4%B8%8D%E5%88%B0video%E7%BB%84%E4%BB%B6ref%E9%97%AE%E9%A2%98/">
        <img class="post-cover" src="https://blog-1302037900.cos.ap-guangzhou.myqcloud.com/images/covers/uniapp.png" />
        <div class="post-info">
          <span class="title">uniapp获取不到video组件ref问题</span>
          <span class="time">2022-09-02</span>
        </div>
      </a>
    </li>
  </ul>
    </div>
  </aside>
</section>
</div>

<div class="preview-overlay">
  <div class="preview-wrapper">
    <img class="preview-img" alt="Preview" />
    <div class="slot"></div>
    <ul class="img-list"></ul>
  </div>
</div>

<script src="/js/page/post/index.js" type="module" defer></script>

    <div id="theme-btn" class="iconfont"></div>
  </main>
  <footer class="page-footer animate__animated animate__fadeIn">
  
  <p class="footer__desc">
    
  </p>
  <p class="copyright">Copyright © 2020-2023 Akino </span>
  <p>Powered by <a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> & <a href="https://github.com/FE-Alog/hexo-theme-alog" title="Hexo-theme-alog" target="_blank" rel="noopener">Hexo-theme-alog</a> </p>
  
</footer>
</body>


    <script>
      window.CONFIG = {"search":{"path":"/search.xml","local_search":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":true,"trigger":"auto"}},"i18n":{"search":{"title":"本地搜索","result_title":"${resultNum} 条结果","placeholder":"请输入关键字","no_result":"搜索不到呢~","tips":"搜索"}}};
    </script>
  

</html>